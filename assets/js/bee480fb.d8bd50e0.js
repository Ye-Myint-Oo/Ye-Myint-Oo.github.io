"use strict";(self.webpackChunkyemyintoo_blog=self.webpackChunkyemyintoo_blog||[]).push([[510],{2800:function(e,t,o){o.r(t),o.d(t,{frontMatter:function(){return s},contentTitle:function(){return i},metadata:function(){return c},toc:function(){return d},default:function(){return p}});var n=o(7462),r=o(3366),l=(o(7294),o(3905)),a=["components"],s={slug:"Dummies guide to set up docker",title:"Docker Set up on centos 8",author:"Ye Myint Oo",tags:["Docker","Script","Setup"]},i=void 0,c={permalink:"/blog/Dummies guide to set up docker",source:"@site/blog/2021-08-27-Docker Set up.md",title:"Docker Set up on centos 8",description:"We are going to install docker CE in centos 8.",date:"2021-08-27T00:00:00.000Z",formattedDate:"August 27, 2021",tags:[{label:"Docker",permalink:"/blog/tags/docker"},{label:"Script",permalink:"/blog/tags/script"},{label:"Setup",permalink:"/blog/tags/setup"}],readingTime:1.605,truncated:!0,prevItem:{title:"Redis Set up on centos 7",permalink:"/blog/Redis installation on centos 7"},nextItem:{title:"Certificates",permalink:"/blog/Planed to achieve certificates"}},d=[{value:"Install the yum-utils package",id:"install-the-yum-utils-package",children:[]},{value:"Install Docker",id:"install-docker",children:[]},{value:"Start/Eanble Docker Service",id:"starteanble-docker-service",children:[]},{value:"Verify Docker Service",id:"verify-docker-service",children:[]},{value:"Rootless Mode change",id:"rootless-mode-change",children:[]}],u={toc:d};function p(e){var t=e.components,o=(0,r.Z)(e,a);return(0,l.kt)("wrapper",(0,n.Z)({},u,o,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"We are going to install docker CE in centos 8.\nHere I am not going to explain what is docker and what the image. We will have another chapter.\nOnly Script with steps by steps and some experienced issues during set up."),(0,l.kt)("p",null,"Recommended approach,"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"Set up Docker repositories in your VM"),(0,l.kt)("li",{parentName:"ol"},"Install from repositories"),(0,l.kt)("li",{parentName:"ol"},"Upgrde from repositories")),(0,l.kt)("h3",{id:"install-the-yum-utils-package"},"Install the yum-utils package"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"sudo yum install -y yum-utils\nsudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo\n")),(0,l.kt)("h3",{id:"install-docker"},"Install Docker"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"sudo yum install -y docker-ce docker-ce-cli containerd.io\n")),(0,l.kt)("h3",{id:"starteanble-docker-service"},"Start/Eanble Docker Service"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"sudo systemctl enable docker\nsudo systemctl start docker\n")),(0,l.kt)("h3",{id:"verify-docker-service"},"Verify Docker Service"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"sudo docker run hello-world\n")),(0,l.kt)("h3",{id:"rootless-mode-change"},"Rootless Mode change"),(0,l.kt)("p",null,"Rootless mode allows running the Docker daemon and containers as a non-root user to mitigate potential vulnerabilities in the daemon and the container runtime. Need to create Non-Root User otherwsie you may encounter the follwing error"),(0,l.kt)("p",null,"[ERROR]"," Refusing to install rootless Docker as the root user"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"useradd <USERNAME>\npasswd <YOUR_PASSWORD>\n")),(0,l.kt)("p",null,"Switch to the created Non-Root User"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"id -u\nwhoami\ngrep ^$(whoami): /etc/subuid\ngrep ^$(whoami): /etc/subgid\n")),(0,l.kt)("p",null,"Install specific required packages for centos 8"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"sudo yum install uidmap\nsudo dnf install -y fuse-overlayfs\nsudo dnf install -y iptables\nsudo dnf install -y policycoreutils-python-utils && sudo semanage permissive -a iptables_t\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"cd /usr/bin\ndockerd-rootless-setuptool.sh install\n")),(0,l.kt)("p",null,"Now docker is configured as rootless mode."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'[INFO] systemd not detected, dockerd-rootless.sh needs to be started manually:\nPATH=/usr/bin:/sbin:/usr/sbin:$PATH dockerd-rootless.sh\n[INFO] Creating CLI context "rootless"\nSuccessfully created context "rootless"\n[INFO] Make sure the following environment variables are set (or add them to ~/.bashrc):\n# WARNING: systemd not found. You have to remove XDG_RUNTIME_DIR manually on every logout.\nexport XDG_RUNTIME_DIR=/home/appadmin/.docker/run\nexport PATH=/usr/bin:$PATH\nexport DOCKER_HOST=unix:///home/appadmin/.docker/run/docker.sock\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock\n")),(0,l.kt)("p",null,"If you encounter the above error, we need to export"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"export DOCKER_HOST=unix://$XDG_RUNTIME_DIR/docker.sock\n")),(0,l.kt)("p",null,"Regards"))}p.isMDXComponent=!0}}]);